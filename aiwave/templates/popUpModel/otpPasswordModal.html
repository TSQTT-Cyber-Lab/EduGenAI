<!-- OTP & Password Change Modal -->
<div id="otpPasswordModal" class="modal rbt-modal-box otp-modal fade" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content wrapper modal-small">
      <!-- Close Button -->
      <button type="button" class="close-button" onclick="closeOtpPasswordModal()">
        <i class="fa-sharp fa-regular fa-x"></i>
      </button>
      <!-- Alerts Container -->
      <div id="otpModalAlerts" class="mb--20"></div>
      
      <!-- Step 1: Email Input -->
      <div id="emailStep">
        <h3 class="title mb--0 w-600 mb--20">Forgot Password</h3>
        <form id="emailForm" method="post" autocomplete="off">
          {% csrf_token %}
          <div class="mb--20">
            <label for="resetEmail" class="form-label">Enter your email address</label>
            <input type="email" id="resetEmail" name="email" class="form-control" placeholder="Email address" required />
            <span id="emailError" class="text-danger-600 text-xs mt--10 block"></span>
          </div>
          <button type="submit" class="btn-default w-100" id="sendOtpBtn">
            <span class="btn-text">Send OTP</span>
            <span class="btn-loading d-none">
              <i class="fa-solid fa-spinner fa-spin"></i> Sending...
            </span>
          </button>
        </form>
      </div>
      <!-- Step 2: OTP Verification -->
      <div id="otpStep" class="d-none">
        <h3 class="title mb--0 w-600 mb--20">OTP Verification</h3>
        <form id="otpForm" method="post" autocomplete="off">
          {% csrf_token %}
          <div class="mb--20">
            <label for="otpInput" class="form-label">Enter the OTP sent to your email</label>
            <input type="text" id="otpInput" name="otp" maxlength="6" pattern="[0-9]{6}" class="form-control" placeholder="6-digit OTP" required />
            <span id="otpError" class="text-danger-600 text-xs mt--10 block"></span>
          </div>
          <button type="submit" class="btn-default w-100" id="verifyOtpBtn">
            <span class="btn-text">Verify OTP</span>
            <span class="btn-loading d-none">
              <i class="fa-solid fa-spinner fa-spin"></i> Verifying...
            </span>
          </button>
        </form>
        <div class="mt--10 text-center">
          <button type="button" class="btn-read-more" id="resendOtpBtn">
            <span class="btn-text">Resend OTP</span>
            <span class="btn-loading d-none">
              <i class="fa-solid fa-spinner fa-spin"></i> Sending...
            </span>
          </button>
        </div>
      </div>
      <!-- Step 3: Password Change -->
      <div id="passwordStep" class="d-none">
        <h3 class="title mb--0 w-600 mb--20">Change Password</h3>
        <form id="passwordForm" method="post" autocomplete="off">
          {% csrf_token %}
          <div class="mb--20">
            <label for="newPassword" class="form-label">New Password</label>
            <input type="password" id="newPassword" name="new_password" class="form-control" placeholder="Enter new password" required />
          </div>
          <div class="mb--20">
            <label for="confirmPassword" class="form-label">Confirm Password</label>
            <input type="password" id="confirmPassword" name="confirm_password" class="form-control" placeholder="Confirm new password" required />
            <span id="passwordError" class="text-danger-600 text-xs mt--10 block"></span>
          </div>
          <button type="submit" class="btn-default w-100" id="changePasswordBtn">
            <span class="btn-text">Change Password</span>
            <span class="btn-loading d-none">
              <i class="fa-solid fa-spinner fa-spin"></i> Changing...
            </span>
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
